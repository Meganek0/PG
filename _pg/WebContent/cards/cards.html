<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>카드</title>
<link href="cards.css" rel="stylesheet" type="text/css"/>
<script src="jquery-3.2.1.js"></script>
<script src="jquery-ui-1.12.1.js"></script>
<script src="jquery-ui-touch-punch.js"></script>
</head>

<body>
	<noscript><p>스크립트 켜라</p></noscript>
	<div id="troll">
		<div id="header">
			<div class="at-header-wrapper">
				<a class="at-activity-name">활동명</a>
				<a class="at-activity-perm">공개상태</a>
				<a class="at-logo">
					<span class="at-logo-icon"></span>
					<span class="at-logo-text">TROLLO</span>
				</a>
				<a class="at-menubtn" href="#">
					<span class="at-menu-icon"></span>
				</a>
				<div class="at-menu hide">
					<div class="at-menu-header">
						<div class="at-menu-header-title">메뉴</div>
						<div class="at-menu-header-close"></div>
					</div>
					<div class="at-menu-content">
						<div class="at-menu-item at-menu-name">활동명 변경
						<div style="width=200;height"></div></div>
						<div class="at-menu-item at-menu-perm">공개상태 변경</div>
						<div class="at-menu-item at-menu-background">
							<div class="at-background-image">
								<span class="at-background-image-uploadbtn">사진</span>
								<input type="file" class="at-background-image-input" style="display:none;"/>
							</div>
							<div class="at-background-color">
								<input type="color" class="at-background-color-input">
							</div>
						</div>
						<div class="at-menu-item at-menu-board">추가,삭제시 팝업
						<input type="checkbox" class="at-delblock-dialog">삭제</div>
					</div>
				</div>
			</div>
		</div>
		<div id="content">
			<div id="at-board">
				<div class="at-board-list">
					<div class="at-board-list-header">테스트박스</div>
				</div>
			</div>
			<div class="at-board-menulist">
				<div class="at-board-menu at-addblock"><span class="at-addblock-icon"></span></div>
				<div class="at-board-menu at-delblock"><span class="at-delblock-icon"></span></div>
			</div>
		</div>
	</div>
</body>
<script>
	//READY!
	$(document).ready(function() {
		$(".at-board-list").draggable({
			addClasses: false,
			scroll: false,
			classes:{
				"ui-draggable-handle": "at-sanic",
				"ui-draggable-dragging": "at-gottagofast"
			},
			create:function(e,u){$(this).removeClass("ui-draggable-handle")},
			start:function(e,u){$(this).removeClass("ui-draggable-dragging")},
			stop: function(e,u){
				if($(this).position().left < 0){
					$(this).animate({left:0},200,"easeOutExpo",function(){})
				}    
				if($(this).position().top < 0){
					$(this).animate({top:0},200,"easeOutExpo",function(){})
				}
			} 
		});
	});
	
	//추가 블록
	$(".at-addblock").on("click",function(e){
		$newlist = $("<div>").text("테스트박스").addClass("at-board-list").css({
			left: e.pageX,
			top: e.pageY-30,
			position: "absolute"
		}).draggable({
			addClasses: false,
			scroll: false,
			classes:{
				"ui-draggable-handle": "at-sanic",
				"ui-draggable-dragging": "at-gottagofast"
			},
			create:function(e,u){$(this).removeClass("ui-draggable-handle")},
			start:function(e,u){$(this).removeClass("ui-draggable-dragging")},
			stop: function(e,u){
				if($(this).position().left < 0){
					$(this).animate({left:0},200,"easeOutExpo",function(){})
				}    
				if($(this).position().top < 0){
					$(this).animate({top:0},200,"easeOutExpo",function(){})
				}
			} 
		});
		
		$("#at-board").append($newlist);
		
		$newlist.animate({
			left: Math.floor(Math.random() * ($("#content").prop("scrollWidth")-$newlist.width())),
			top: Math.floor(Math.random() * ($("#content").prop("scrollHeight")-$newlist.height()))
		},400,"easeOutExpo");
	})
	
	//삭제 블록
	$(".at-delblock").droppable({
		addClasses: false,
		accept: ".at-board-list",
		drop: function(e,u){
			if($(".at-delblock-dialog")[0].checked){
				return;
			}
			u.draggable.remove();
		}
	})
	
	//헤더 메뉴 임시
	$(".at-menubtn").on("click", function(){
		$(".at-menu").removeClass("hide",200,"linear")
		$(".at-menubtn").addClass("hide")
	})
	$(".at-menu-header-close").on("click", function(){
		$(".at-menu").addClass("hide",200,"linear")
		$(".at-menubtn").removeClass("hide",200)
	})
	$(".at-background-image-uploadbtn").on("click", function(){
		$(".at-background-image-input").trigger("click");
	})
	$(".at-background-image-input").on("change", function(){
		console.log(this.files[0])
		if(this.files[0].type.startsWith("image")){
		//업로드 후 실행
			$("html").css({
				"background":"url('img/bf4bg2.jpg')",
				"background-size":"cover"
			});
		}
		
	})
	$(".at-background-color-input").on("change",function(){
		$("html").css({
			"background":$(this).val(),
			"background-size":"cover"
		});
	})
	
	
</script>
</html>